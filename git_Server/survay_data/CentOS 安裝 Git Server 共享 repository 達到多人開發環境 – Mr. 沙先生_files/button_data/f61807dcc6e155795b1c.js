(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{269:function(e,t,r){"use strict";function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.isCivicLikerTrial||e.isSubscribedCivicLiker?"civic-liker":"none"}r.d(t,"a",(function(){return n}))},301:function(e,t,r){"use strict";r.r(t);r(69),r(55);var n=r(67),o=(r(56),r(58),r(116)),c=(r(68),r(48),r(39),r(38),r(54),r(64),r(24)),h=(r(158),r(28),r(31)),l=r(253),d=r(269),k=r(258),f=r(278);function v(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}function w(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?v(Object(source),!0).forEach((function(t){Object(h.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):v(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var m={mixins:[f.a],data:function(){return{isUserFetched:!1,isDisplayed:!1,isInteracted:!1,isReadTimerEnded:!1,readTimer:null,isShowLikeButton:!0}},computed:{popupURL:function(){var e="/in/like/".concat(this.id,"/?referrer=").concat(encodeURIComponent(this.referrer));return this.buttonType&&(e+="&type=".concat(encodeURIComponent(this.buttonType))),e},isPreview:function(){return"1"===this.$route.query.preview}},head:function(){var link=[];return this.isUserFetched&&!this.isLoggedIn&&(this.hasCookieSupport?window.doNotTrack||navigator.doNotTrack||link.push({rel:"prefetch",href:this.signUpURL}):link.push({rel:"prefetch",href:this.popupURL})),{link:link}},mounted:function(){var e=this;return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:try{window.top.postMessage({action:"MOUNTED"},this.referrer)}catch(e){console.error(e)}if(window.addEventListener("message",this.handleWindowMessage),!this.isPreview){t.next=4;break}return t.abrupt("return");case 4:return this.readTimer=setTimeout((function(){e.isReadTimerEnded=!0}),1e4),t.next=7,regeneratorRuntime.awrap(this.getIsCookieSupport());case 7:return this.hasCookieSupport=t.sent,this.parentSuperLikeID=this.getParentSuperLikeID(),t.next=11,regeneratorRuntime.awrap(this.updateUserSignInStatus());case 11:this.onCheckCookieSupport&&this.onCheckCookieSupport(this.hasCookieSupport),this.isUserFetched=!0;case 13:case"end":return t.stop()}}),null,this)},beforeDestroy:function(){window.removeEventListener("message",this.handleWindowMessage)},watch:{referrer:function(){this.updateUserSignInStatus()},isDisplayed:function(){this.checkShouldPostReadEvent()},isInteracted:function(){this.checkShouldPostReadEvent()},isReadTimerEnded:function(){this.checkShouldPostReadEvent()}},methods:{openPopup:function(e){var t="".concat(this.popupURL,"&action=").concat(e);if(Object(o.f)()&&Object(o.g)())try{return void(window.top.location.href=t)}catch(e){console.error(e)}var r=window.open(t,"like","menubar=no,location=no,width=576,height=768");this.$root.$emit("openPopupNoticeOverlay",r)},setIsDisplayed:function(){this.isDisplayed=!0},setIsInteracted:function(){this.isInteracted=!0},checkShouldPostReadEvent:function(){return regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isRead||!(this.isReadTimerEnded&&this.isDisplayed||this.isInteracted)){e.next=3;break}return e.next=3,regeneratorRuntime.awrap(this.postReadEvent());case 3:case"end":return e.stop()}}),null,this)},postReadEvent:function(){var e;return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.isRead){t.next=2;break}return t.abrupt("return");case 2:return this.isRead=!0,t.prev=3,t.next=6,regeneratorRuntime.awrap(Object(k.p)(this.id,w({referrer:this.referrer,isCookieSupport:this.hasCookieSupport},this.apiMetadata)));case 6:t.next=12;break;case 8:t.prev=8,t.t0=t.catch(3),(e=t.t0.message||t.t0.toString()).includes("timeout")||e.includes("Network Error")||console.error(t.t0);case 12:this.readTimer&&clearTimeout(this.readTimer);case 13:case"end":return t.stop()}}),null,this,[[3,8]])},handleWindowMessage:function(e){var data,t,r,n=this;return regeneratorRuntime.async((function(o){for(;;)switch(o.prev=o.next){case 0:if(data=e.data,"object"===Object(c.a)(data)){o.next=3;break}return o.abrupt("return");case 3:if(e.source!==window.parent&&e.source!==window.top){o.next=14;break}o.t0=data.action,o.next="SET_REFERRER"===o.t0?7:"DISABLE_BUTTON"===o.t0?12:14;break;case 7:if(void 0!==(t=data.content.referrer)){o.next=10;break}return o.abrupt("return");case 10:return this.$router.replace({name:this.$route.name,params:this.$route.params,hash:this.$route.hash,query:w({},this.$route.query,{referrer:t})}),o.abrupt("break",14);case 12:return this.isShowLikeButton=!1,o.abrupt("break",14);case 14:if(e.origin!=="https://".concat(l.f)){o.next=36;break}o.t1=data.action,o.next="LOGGED_IN"===o.t1?18:"PREVIEW"===o.t1?31:36;break;case 18:return o.next=20,regeneratorRuntime.awrap(this.updateUserSignInStatus());case 20:o.t2=this.postSignInAction,o.next="like"===o.t2?23:"save"===o.t2?25:"follow"===o.t2?27:29;break;case 23:return this.$nextTick((function(){n.$refs.likeButton&&n.$refs.likeButton.onClick()})),o.abrupt("break",30);case 25:return this.hasBookmarked||this.onClickSaveButton(),o.abrupt("break",30);case 27:return this.hasFollowedCreator||this.onClickFollowButton(),o.abrupt("break",30);case 29:return o.abrupt("break",30);case 30:return o.abrupt("break",36);case 31:if(this.isPreview){o.next=33;break}return o.abrupt("return");case 33:return(r=data.content.user)&&(r.user&&(this.id=r.user),r.displayName&&(this.displayName=r.displayName),r.avatar&&(this.avatar=r.avatar),this.avatarHalo=Object(d.a)(r)),o.abrupt("break",36);case 36:case"end":return o.stop()}}),null,this)}}},S=r(273),L=r(279),y=r(272),C=r(275),x=r(260),O={name:"embed-id-button",layout:"embedv2",components:{Identity:S.a,LikeCoinButtonWidget:L.c,LikeButton:y.a,SaveButton:C.a},mixins:[m],data:function(){return{isUserFetched:!1,isShowAltMode:!1,intersectionObserver:null}},computed:{widgetLayout:function(){if(this.isShowAltMode){var e=this.$route.query.mode;if(L.a.includes(e))return e}return L.b},hasAltMode:function(){var e=this.$route.query.mode;return L.a.includes(e)&&e!==L.b}},mounted:function(){var e=this;this.hasAltMode&&(this.isShowAltMode=!0,window.addEventListener("message",this.onReceiveMessage,!1)),window.IntersectionObserver&&(this.intersectionObserver||(this.intersectionObserver=new IntersectionObserver((function(t){var r=Object(n.a)(t,1)[0];r&&r.isIntersecting&&e.setIsDisplayed()}))),this.intersectionObserver.observe(this.$el))},beforeDestory:function(){window.removeEventListener("message",this.onReceiveMessage,!1)},destroyed:function(){this.intersectionObserver&&(this.intersectionObserver.disconnect(),this.intersectionObserver=null)},methods:{onClickInteraction:function(){return regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:this.setIsInteracted();case 1:case"end":return e.stop()}}),null,this)},doLogin:function(e){var t;return regeneratorRuntime.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(!this.isPreview){r.next=2;break}return r.abrupt("return");case 2:if(this.postSignInAction=e,!(!this.hasCookieSupport||Object(o.f)()&&Object(o.g)())){r.next=18;break}if(this.openPopup(e),t=e.replace(/^./,(function(s){return s.toUpperCase()})),Object(x.a)(this,"LikeButtonFlow","popup".concat(t),"popup".concat(t,"(embed)"),1),this.hasStorageAPIAccess){r.next=16;break}return r.next=10,regeneratorRuntime.awrap(Object(o.h)());case 10:if(!r.sent){r.next=16;break}return r.next=13,regeneratorRuntime.awrap(this.getIsCookieSupport());case 13:return this.hasCookieSupport=r.sent,r.next=16,regeneratorRuntime.awrap(this.updateUserSignInStatus());case 16:r.next=20;break;case 18:this.signUp(),Object(x.a)(this,"LikeButtonFlow","popupSignUp","popupSignUp(embed)",1);case 20:case"end":return r.stop()}}),null,this)},doLike:function(){return regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isMaxLike||this.isCreator){e.next=5;break}this.like(),Object(x.a)(this,"LikeButtonFlow","clickLike","clickLike(embed)",1),e.next=13;break;case 5:if(!this.canSuperLike){e.next=12;break}return e.next=8,regeneratorRuntime.awrap(this.newSuperLike());case 8:return e.next=10,regeneratorRuntime.awrap(this.updateSuperLikeStatus());case 10:e.next=13;break;case 12:this.showCivicLikerCTA();case 13:case"end":return e.stop()}}),null,this)},getShouldShowCivicLikerCTA:function(){if(void 0===this.ctaClickCount)this.ctaClickCount=1;else if(this.ctaClickCount=(this.ctaClickCount+1)%5,0!==this.ctaClickCount)return!1;return!0},showCivicLikerCTA:function(){this.getShouldShowCivicLikerCTA()&&(this.goToPortfolio({type:"popup",target:"civic-liker-cta",feature:"width=540,height=640,menubar=no,location=no,resizable=yes,scrollbars=yes,status=yes"}),Object(x.a)(this,"LikeButtonFlow","clickCivicLikerCTA","clickCivicLikerCTA(embed)",1))},onClickLike:function(){return regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(x.a)(this,"LikeButtonFlow","clickLikeButton","clickLikeButton(embed)",1),!this.isLoggedIn){e.next=5;break}this.doLike(),e.next=7;break;case 5:return e.next=7,regeneratorRuntime.awrap(this.doLogin("like"));case 7:case"end":return e.stop()}}),null,this)},onClickLikeStats:function(){this.openLikeStats(),Object(x.a)(this,"LikeButtonFlow","clickLikeStats","clickLikeStats(embed)",1)},onClickAvatar:function(){Object(x.a)(this,"LikeButtonFlow","clickAvatar","clickAvatar(embed)",1),this.goToPortfolio()},onClickSaveButton:function(){return regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(x.a)(this,"LikeButtonFlow","clickSaveButton","clickSaveButton(embed)",1),!this.isLoggedIn){e.next=5;break}this.toggleBookmark(),e.next=7;break;case 5:return e.next=7,regeneratorRuntime.awrap(this.doLogin("save"));case 7:case"end":return e.stop()}}),null,this)},handleMessageAction:function(e,t){switch(t){case"showAltMode":this.isShowAltMode=!0;break;case"hideAltMode":this.isShowAltMode=!1}e&&e.source&&e.source.postMessage(JSON.stringify({ack:t}),e.origin)},onReceiveMessage:function(e){var t=this,r=[];try{r=JSON.parse(e.data).actions}catch(e){return void console.error(e)}Array.isArray(r)?r.forEach((function(r){t.handleMessageAction(e,r)})):this.handleMessageAction(e,r)}}},R=r(19),component=Object(R.a)(O,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{on:{click:e.onClickInteraction}},[r("LikeCoinButtonWidget",{attrs:{layout:e.widgetLayout,"like-button-label":e.likeButtonLabel,"cta-button-label":e.ctaButtonLabel,"cta-button-preset":e.ctaButtonPreset,"hint-label":e.hintText,"is-show-like-button":e.isShowLikeButton},on:{"click-like-button-label":e.onClickLikeStats,"click-cta-button":e.onClickCTAButton},scopedSlots:e._u([{key:"like-button",fn:function(){return[r("LikeButton",{ref:"likeButton",attrs:{count:e.likeCount,cooldown:e.cooldownProgress,"cooldown-end-time":e.nextSuperLikeTime,"has-super-liked":e.hasSuperLiked,"is-just-super-liked":e.isJustSuperLiked,"is-super-like-enabled":e.isSuperLiker,"is-creator":e.isCreator},on:{click:e.onClickLike,"click-disabled":e.onClickCooldown,"cooldown-end":e.updateSuperLikeStatus}})]},proxy:!0},{key:"save-button",fn:function(t){return[r("SaveButton",e._b({attrs:{toggled:e.hasBookmarked},on:{click:e.onClickSaveButton}},"SaveButton",t,!1))]}},{key:"identity",fn:function(t){return[r("Identity",e._b({attrs:{avatarURL:e.avatar,"display-name":e.displayName,"is-avatar-button-outlined":e.isCreatorCivicLiker},on:{"click-avatar":e.onClickAvatar,"click-display-name":e.onClickAvatar}},"Identity",t,!1))]}}])})],1)}),[],!1,null,null,null);t.default=component.exports}}]);
//# sourceMappingURL=f61807dcc6e155795b1c.js.map